<?php
return unserialize("a:5:{i:0;a:1:{i:0;a:1:{i:0;a:5:{i:0;s:33:\"tcpfunc_5ac68f2439cda5.65578220_1\";i:1;a:0:{}i:2;i:1;i:3;s:0:\"\";i:4;s:0:\"\";}}}i:1;a:0:{}i:2;s:8:\"checking\";i:3;N;i:4;a:1:{s:33:\"tcpfunc_5ac68f2439cda5.65578220_1\";s:48740:\"\$tpl_funcs['tcpfunc_5ac68f2439cda5.65578220_1']=\$KEEP_TPL_FUNCS['tcpfunc_5ac68f2439cda5.65578220_1']=recall_named_function('5ac68f2439d177.43904617','\$parameters,\$cl',\"echo \\\"/* Validation code and other general code relating to forms */\\\\n\\\\n\\\\\\\"use strict\\\\\\\";\\\\n\\\\nnew Image().src='\\\",\\n	ecv_IMG(\\\$cl,array(2),array(\\\"loading\\\",\\\"0\\\",\\\"BeatGrid_CSM\\\")),\\n	\\\"'.replace(/^https?:/,window.location.protocol);\\\\n\\\\nfunction password_strength(ob)\\\\n{\\\\n	if (ob.name.indexOf('2')!=-1) return;\\\\n	if (ob.name.indexOf('confirm')!=-1) return;\\\\n\\\\n	var _ind=document.getElementById('password_strength_'+ob.id);\\\\n	if (!_ind) return;\\\\n	var ind=_ind.getElementsByTagName('div')[0];\\\\n	var post='password='+window.encodeURIComponent(ob.value);\\\\n	if (ob.form && typeof ob.form.elements['username']!='undefined')\\\\n	{\\\\n		post+='&username='+ob.form.elements['username'].value;\\\\n	} else\\\\n	{\\\\n		if (ob.form && typeof ob.form.elements['edit_username']!='undefined')\\\\n		{\\\\n			post+='&username='+ob.form.elements['edit_username'].value;\\\\n		}\\\\n	}\\\\n	var strength=load_snippet('password_strength',post);\\\\n	strength*=2; if (strength>10) strength=10; // Normally too harsh!\\\\n	ind.style.width=(strength*10)+'px';\\\\n	if (strength>=6)\\\\n		ind.style.backgroundColor='green';\\\\n	else if (strength<4)\\\\n		ind.style.backgroundColor='red';\\\\n	else\\\\n		ind.style.backgroundColor='orange';\\\\n	ind.parentNode.style.display=(ob.value.length==0)?'none':'block';\\\\n}\\\\n\\\\nfunction fix_form_enter_key(form)\\\\n{\\\\n	var submit=document.getElementById('submit_button');\\\\n	var inputs=form.getElementsByTagName('input');\\\\n	var type;\\\\n	for (var i=0;i<inputs.length;i++)\\\\n	{\\\\n		type=inputs[i].type;\\\\n		if (((type=='text') || (type=='password') || (type=='color') || (type=='email') || (type=='number') || (type=='range') || (type=='search') || (type=='tel') || (type=='url'))\\\\n		 && (typeof submit.onclick!='undefined') && (submit.onclick)\\\\n		 && ((typeof inputs[i].onkeypress=='undefined') || (!inputs[i].onkeypress)))\\\\n			inputs[i].onkeypress=function(event) { if (typeof event=='undefined') event=window.event; if (enter_pressed(event)) submit.onclick(event); };\\\\n	}\\\\n}\\\\n\\\\nfunction radio_value(radios)\\\\n{\\\\n	for (var i=0;i<radios.length;i++)\\\\n	{\\\\n		if (radios[i].checked) return radios[i].value;\\\\n	}\\\\n	return '';\\\\n}\\\\n\\\\nfunction get_errormsg_element(id)\\\\n{\\\\n	var errormsg_element=document.getElementById('error_'+id);\\\\n	if (!errormsg_element)\\\\n	{\\\\n		errormsg_element=document.getElementById('error_'+id.replace(/\\\\\\\\_day\\\\\\\$/,'').replace(/\\\\\\\\_month\\\\\\\$/,'').replace(/\\\\\\\\_year\\\\\\\$/,'').replace(/\\\\\\\\_hour\\\\\\\$/,'').replace(/\\\\\\\\_minute\\\\\\\$/,''));\\\\n	}\\\\n	return errormsg_element;\\\\n}\\\\n\\\\nfunction set_field_error(the_element,error_msg)\\\\n{\\\\n	if (typeof the_element.name!='undefined')\\\\n	{\\\\n		var id=the_element.name;\\\\n		var errormsg_element=get_errormsg_element(id);\\\\n		if ((error_msg=='') && (id.indexOf('_hour')!=-1) || (id.indexOf('_minute')!=-1)) return; // Do not blank out as day/month/year (which comes first) would have already done it\\\\n		if (errormsg_element)\\\\n		{\\\\n			// Make error message visible, if there's an error\\\\n			errormsg_element.style.display=(error_msg=='')?'none':'block';\\\\n\\\\n			// Changed error message\\\\n			if (get_inner_html(errormsg_element)!=escape_html(error_msg))\\\\n			{\\\\n				set_inner_html(errormsg_element,'');\\\\n				if (error_msg!='') // If there actually an error\\\\n				{\\\\n					the_element.setAttribute('aria-invalid','true');\\\\n\\\\n					// Need to switch tab?\\\\n					var p=errormsg_element;\\\\n					while (p!==null)\\\\n					{\\\\n						p=p.parentNode;\\\\n						if ((error_msg.substr(0,5)!='\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"DISABLED_FORM_FIELD\\\",array()),\\n	\\\"'.substr(0,5)) && (p) && (typeof p.getAttribute!='undefined') && (p.getAttribute('id')) && (p.getAttribute('id').substr(0,2)=='g_') && (p.style.display=='none'))\\\\n						{\\\\n							select_tab('g',p.getAttribute('id').substr(2,p.id.length-2),false,true);\\\\n							break;\\\\n						}\\\\n					}\\\\n\\\\n					// Set error message\\\\n					var msg_node=document.createTextNode(error_msg);\\\\n					errormsg_element.appendChild(msg_node);\\\\n					errormsg_element.setAttribute('role','alert');\\\\n\\\\n					// Fade in\\\\n					if (typeof window.fade_transition!='undefined')\\\\n					{\\\\n						set_opacity(errormsg_element,0.0);\\\\n						fade_transition(errormsg_element,100,30,4);\\\\n					}\\\\n				} else\\\\n				{\\\\n					the_element.setAttribute('aria-invalid','false');\\\\n					errormsg_element.setAttribute('role','');\\\\n				}\\\\n			}\\\\n		}\\\\n	}\\\\n	if ((typeof window.is_wysiwyg_field!='undefined') && (is_wysiwyg_field(the_element))) the_element=the_element.parentNode;\\\\n	the_element.className=the_element.className.replace(/( input_erroneous(\\\\\\\$| ))+/g,' ');\\\\n	if (error_msg!='')\\\\n	{\\\\n		the_element.className=the_element.className+' input_erroneous';\\\\n	}\\\\n}\\\\n\\\\nfunction try_to_simplify_iframe_form()\\\\n{\\\\n	var form_cat_selector=document.getElementById('main_form'),i,element,count=0,found,foundButton;\\\\n	if (!form_cat_selector) return;\\\\n	var inputs=form_cat_selector.getElementsByTagName('input');\\\\n	var buttons=form_cat_selector.getElementsByTagName('button');\\\\n	var selects=form_cat_selector.getElementsByTagName('select');\\\\n	var textareas=form_cat_selector.getElementsByTagName('select');\\\\n	var elements=[];\\\\n	for (i=0;i<inputs.length;i++) elements.push(inputs[i]);\\\\n	for (i=0;i<buttons.length;i++) elements.push(buttons[i]);\\\\n	for (i=0;i<selects.length;i++) elements.push(selects[i]);\\\\n	for (i=0;i<textareas.length;i++) elements.push(textareas[i]);\\\\n	for (i=0;i<elements.length;i++)\\\\n	{\\\\n		element=elements[i];\\\\n		if (((element.nodeName.toLowerCase()=='input') && (element.getAttribute('type')!='hidden') && (element.getAttribute('type')!='button') && (element.getAttribute('type')!='image') && (element.getAttribute('type')!='submit')) || (element.nodeName.toLowerCase()=='select') || (element.nodeName.toLowerCase()=='textarea'))\\\\n		{\\\\n			found=element;\\\\n			count++;\\\\n		}\\\\n		if (((element.nodeName.toLowerCase()=='input') && ((element.getAttribute('type')=='button') || (element.getAttribute('type')=='image') || (element.getAttribute('type')=='submit'))) || (element.nodeName.toLowerCase()=='button'))\\\\n		{\\\\n			foundButton=element;\\\\n		}\\\\n	}\\\\n\\\\n	if ((count==1) && (found.nodeName.toLowerCase()=='select'))\\\\n	{\\\\n		var iframe=document.getElementById('iframe_under');\\\\n		found.onchange=function() {\\\\n			if (iframe)\\\\n			{\\\\n				if ((iframe.contentDocument) && (iframe.contentDocument.getElementsByTagName('form').length!=0))\\\\n				{\\\\n					window.fauxmodal_confirm(\\\\n						'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"Q_SURE_LOSE\\\",array()),\\n	\\\"',\\\\n						function(result)\\\\n						{\\\\n							if (result)\\\\n							{\\\\n								_simplified_form_continue_submit(iframe,form_cat_selector);\\\\n							}\\\\n						}\\\\n					);\\\\n\\\\n					return null;\\\\n				}\\\\n			}\\\\n\\\\n			_simplified_form_continue_submit(iframe,form_cat_selector);\\\\n\\\\n			return null;\\\\n		};\\\\n		if ((found.getAttribute('size')>1) || (found.multiple)) found.onclick=found.onchange;\\\\n		if (iframe)\\\\n		{\\\\n			foundButton.style.display='none';\\\\n		}\\\\n	}\\\\n}\\\\n\\\\nfunction _simplified_form_continue_submit(iframe,form_cat_selector)\\\\n{\\\\n	if (check_form(form_cat_selector))\\\\n	{\\\\n		if (iframe) animate_frame_load(iframe,'iframe_under');\\\\n		form_cat_selector.submit();\\\\n	}\\\\n}\\\\n\\\\nfunction do_form_submit(form,event)\\\\n{\\\\n	if (!check_form(form,false)) return false;\\\\n\\\\n	if ((typeof form.old_action!='undefined') && (form.old_action)) form.setAttribute('action',form.old_action);\\\\n	if ((typeof form.old_target!='undefined') && (form.old_target)) form.setAttribute('target',form.old_target);\\\\n	if (!form.getAttribute('target')) form.setAttribute('target','_top');\\\\n\\\\n	/* Remove any stuff that is only in the form for previews if doing a GET request */\\\\n	if (form.method.toLowerCase()=='get')\\\\n	{\\\\n		var i=0,name,elements=[];\\\\n		for (i=0;i<form.elements.length;i++)\\\\n		{\\\\n			elements.push(form.elements[i]);\\\\n		}\\\\n		for (i=0;i<elements.length;i++)\\\\n		{\\\\n			name=elements[i].name;\\\\n			if (name && ((name.substr(0,11)=='label_for__') || (name.substr(0,14)=='tick_on_form__') || (name.substr(0,9)=='comcode__') || (name.substr(0,9)=='require__')))\\\\n			{\\\\n				elements[i].parentNode.removeChild(elements[i]);\\\\n			}\\\\n		}\\\\n	}\\\\n	if (form.onsubmit)\\\\n	{\\\\n		var ret=form.onsubmit.call(form,event);\\\\n		if (!ret) return false;\\\\n	}\\\\n	if ((typeof window.just_checking_requirements=='undefined') || (!window.just_checking_requirements)) form.submit();\\\\n\\\\n	disable_buttons_just_clicked(document.getElementsByTagName('input'));\\\\n	disable_buttons_just_clicked(document.getElementsByTagName('button'));\\\\n\\\\n	if (typeof window.detect_interval!='undefined')\\\\n	{\\\\n		window.clearInterval(window.detect_interval);\\\\n		window.detect_interval=null;\\\\n	}\\\\n\\\\n	return true;\\\\n}\\\\n\\\\nfunction disable_buttons_just_clicked(inputs,permanent)\\\\n{\\\\n	if (typeof permanent=='undefined') permanent=false;\\\\n\\\\n	for (var i=0;i<inputs.length;i++)\\\\n	{\\\\n		if ((inputs[i].nodeName.toLowerCase()=='button') || (inputs[i].type=='image') || (inputs[i].type=='submit') || (inputs[i].type=='button'))\\\\n		{\\\\n			if ((inputs[i].getAttribute('accesskey')=='u' /* Identifies submit button */) || (inputs[i].getAttribute('accesskey')=='p' /* Identifies preview button */))\\\\n			{\\\\n				if ((!inputs[i].disabled) && (!inputs[i].under_timer)) /* We do not want to interfere with other code potentially operating */\\\\n				{\\\\n					disable_button_just_clicked(inputs[i],permanent);\\\\n				}\\\\n			}\\\\n		}\\\\n	}\\\\n}\\\\n\\\\nfunction do_form_preview(event,form,preview_url,has_separate_preview)\\\\n{\\\\n	if (typeof has_separate_preview=='undefined') has_separate_preview=false;\\\\n\\\\n	if (!document.getElementById('preview_iframe'))\\\\n	{\\\\n		fauxmodal_alert('\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"ADBLOCKER\\\",array()),\\n	\\\"');\\\\n		return false;\\\\n	}\\\\n\\\\n	preview_url+=((typeof window.mobile_version_for_preview=='undefined')?'':('&keep_mobile='+(window.mobile_version_for_preview?'1':'0')));\\\\n\\\\n	var old_action=form.getAttribute('action');\\\\n\\\\n	if (!form.old_action) form.old_action=old_action;\\\\n	form.setAttribute('action',/*maintain_theme_in_link - no, we want correct theme images to work*/(preview_url)+((form.old_action.indexOf('&uploading=1')!=-1)?'&uploading=1':''));\\\\n	var old_target=form.getAttribute('target');\\\\n	if (!old_target) old_target='_top'; /* not _self due to edit screen being a frame itself */\\\\n	if (!form.old_target) form.old_target=old_target;\\\\n	form.setAttribute('target','preview_iframe');\\\\n\\\\n	if ((window.check_form) && (!check_form(form,true))) return false;\\\\n\\\\n	if (form.onsubmit)\\\\n	{\\\\n		var test=form.onsubmit.call(form,event,true);\\\\n		if (!test) return false;\\\\n	} \\\\n\\\\n	if ((has_separate_preview) || (window.has_separate_preview))\\\\n	{\\\\n		form.setAttribute('action',form.old_action+((form.old_action.indexOf('?')==-1)?'?':'&')+'preview=1');\\\\n		return true;\\\\n	}\\\\n\\\\n	document.getElementById('submit_button').style.display='inline';\\\\n	//window.setInterval(function() { resize_frame('preview_iframe',window.top.scrollY+window.top.get_window_height()); },1500);\\\\n	var pf=document.getElementById('preview_iframe');\\\\n\\\\n	/* Do our loading-animation */\\\\n	if ((typeof window.just_checking_requirements=='undefined') || (!window.just_checking_requirements))\\\\n	{\\\\n		window.setInterval(window.trigger_resize,500);  /* In case its running in an iframe itself */\\\\n		illustrate_frame_load(pf,'preview_iframe',50);\\\\n	}\\\\n\\\\n	disable_buttons_just_clicked(document.getElementsByTagName('input'));\\\\n	disable_buttons_just_clicked(document.getElementsByTagName('button'));\\\\n\\\\n	/* input.value not readable on most modern web browsers, and this code is not maintained\\\\n	var inputs=form.elements,input;\\\\n	for (var i=0;i<inputs.length-1;i++)\\\\n	{\\\\n		input=inputs[i];\\\\n		if ((input.type=='file') && (!input.name.match(/file\\\\\\\\d*\\\\\\\$/)) && (input.className.indexOf('previews')==-1) && (!input.disabled) && (input.value!=''))\\\\n		{\\\\n			input.disabled=true;\\\\n			window.setTimeout(function() { document.getElementById(input.id).disabled=false; },500);\\\\n		}\\\\n	}*/\\\\n\\\\n	// Turn main post editing back off\\\\n	if (typeof wysiwyg_set_readonly!='undefined') wysiwyg_set_readonly('post',true);\\\\n\\\\n	return true;\\\\n}\\\\n\\\\nfunction clever_find_value(form,element)\\\\n{\\\\n	if ((typeof element.length!='undefined') && (typeof element.nodeName=='undefined'))\\\\n	{\\\\n		// Radio button\\\\n		element=element[0];\\\\n	}\\\\n\\\\n	var value;\\\\n	switch (element.nodeName.toLowerCase())\\\\n	{\\\\n		case 'textarea':\\\\n			value=(typeof window.get_textbox=='undefined')?element.value:get_textbox(element);\\\\n			break;\\\\n		case 'select':\\\\n			value='';\\\\n			if (element.selectedIndex>=0)\\\\n			{\\\\n				if (element.multiple)\\\\n				{\\\\n					for (var i=0;i<element.options.length;i++)\\\\n					{\\\\n						if (element.options[i].selected)\\\\n						{\\\\n							if (value!='') value+=',';\\\\n							value+=element.options[i].value;\\\\n						}\\\\n					}\\\\n				} else if (element.selectedIndex>=0)\\\\n				{\\\\n					value=element.options[element.selectedIndex].value;\\\\n					if ((value=='') && (element.getAttribute('size')>1)) value='-1'; // Fudge, as we have selected something explicitly that is blank\\\\n				}\\\\n			}\\\\n			break;\\\\n		case 'input':\\\\n			switch (element.type)\\\\n			{\\\\n				case 'checkbox':\\\\n					value=(element.checked)?element.value:'';\\\\n					break;\\\\n\\\\n				case 'radio':\\\\n					value='';\\\\n					for (var i=0;i<form.elements.length;i++)\\\\n					{\\\\n						if ((form.elements[i].name==element.name) && (form.elements[i].checked))\\\\n							value=form.elements[i].value;\\\\n					}\\\\n					break;\\\\n\\\\n				case 'hidden':\\\\n				case 'text':\\\\n				case 'color':\\\\n				case 'date':\\\\n				case 'datetime':\\\\n				case 'datetime-local':\\\\n				case 'email':\\\\n				case 'month':\\\\n				case 'number':\\\\n				case 'range':\\\\n				case 'search':\\\\n				case 'tel':\\\\n				case 'time':\\\\n				case 'url':\\\\n				case 'week':\\\\n				case 'password':\\\\n				default:\\\\n					value=element.value;\\\\n					break;\\\\n			}\\\\n	}\\\\n	return value;\\\\n}\\\\n\\\\nfunction check_field(the_element,the_form,for_preview)\\\\n{\\\\n	var i,the_class,required,my_value,erroneous=false,error_msg='',regexp,total_file_size=0,alerted=false;\\\\n\\\\n	// No checking for hidden elements\\\\n	if (((the_element.type=='hidden') || (((the_element.style.display=='none') || (the_element.parentNode.style.display=='none') || (the_element.parentNode.parentNode.style.display=='none') || (the_element.parentNode.parentNode.parentNode.style.display=='none')) && ((typeof window.is_wysiwyg_field=='undefined') || (!is_wysiwyg_field(the_element))))) && ((!the_element.className) || (element_has_class(the_element,'hidden_but_needed'))==null))\\\\n	{\\\\n		return null;\\\\n	}\\\\n	if (the_element.disabled) return null;\\\\n\\\\n	// Test file sizes\\\\n	if ((the_element.type=='file') && (the_element.files) && (the_element.files.item) && (the_element.files.item(0)) && (the_element.files.item(0).fileSize))\\\\n		total_file_size+=the_element.files.item(0).fileSize;\\\\n\\\\n	// Test file types\\\\n	if ((the_element.type=='file') && (the_element.value) && (the_element.name!='file_anytype'))\\\\n	{\\\\n		var allowed_types='3gp,asf,avi,bmp,css,csv,diff,dmg,doc,docx,dot,eml,flv,gif,gz,ico,ini,iso,jpeg,jpg,keynote,log,m4v,mov,mp3,mp4,mpeg,mpg,numbers,odg,odp,ods,odt,ogg,ogv,pages,patch,pdf,pgp,php,png,ppt,pptx,psd,pub,rar,sql,swf,tar,tif,torrent,tpl,txt,wav,webm,wmv,xls,xlsx,zip'.split(/,/);\\\\n		var type_ok=false;\\\\n		var theFileType=the_element.value.indexOf('.')?the_element.value.substr(the_element.value.lastIndexOf('.')+1):'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"NONE\\\",array()),\\n	\\\"';\\\\n		for (var k=0;k<allowed_types.length;k++)\\\\n		{\\\\n			if (allowed_types[k].toLowerCase()==theFileType.toLowerCase()) type_ok=true;\\\\n		}\\\\n		if (!type_ok)\\\\n		{\\\\n			error_msg='\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"INVALID_FILE_TYPE\\\",array(\\\"xx1xx\\\",\\\"3gp,asf,avi,bmp,css,csv,diff,dmg,doc,docx,dot,eml,flv,gif,gz,ico,ini,iso,jpeg,jpg,keynote,log,m4v,mov,mp3,mp4,mpeg,mpg,numbers,odg,odp,ods,odt,ogg,ogv,pages,patch,pdf,pgp,php,png,ppt,pptx,psd,pub,rar,sql,swf,tar,tif,torrent,tpl,txt,wav,webm,wmv,xls,xlsx,zip\\\")),\\n	\\\"'.replace(/xx1xx/g,theFileType).replace(/<[^>]*>/g,'').replace(/&[lr][sd]quo;/g,'\\\\\\\\'').replace(/,/g,', ');\\\\n			if (!alerted) window.fauxmodal_alert(error_msg);\\\\n			alerted=true;\\\\n		}\\\\n	}\\\\n\\\\n	// Fix up bad characters\\\\n	if ((browser_matches('ie')) && (the_element.value) && (the_element.nodeName.toLowerCase()!='select'))\\\\n	{\\\\n		var bad_word_chars=[8216,8217,8220,8221];\\\\n		var fixed_word_chars=['\\\\\\\\'','\\\\\\\\'','\\\\\\\"','\\\\\\\"'];\\\\n		for (i=0;i<bad_word_chars.length;i++)\\\\n		{\\\\n			regexp=new RegExp(String.fromCharCode(bad_word_chars[i]),'gm');\\\\n			the_element.value=the_element.value.replace(regexp,fixed_word_chars[i]);\\\\n		}\\\\n	}\\\\n\\\\n	// Class name\\\\n	the_class=first_class_name(the_element.className);\\\\n\\\\n	// Find whether field is required and value of it\\\\n	if (the_element.type=='radio')\\\\n	{\\\\n		required=(typeof the_form.elements['require__'+the_element.name]!='undefined') && (the_form.elements['require__'+the_element.name].value=='1');\\\\n	} else\\\\n	{\\\\n		required=the_element.className.indexOf('_required')!=-1;\\\\n	}\\\\n	my_value=clever_find_value(the_form,the_element);\\\\n\\\\n	// Prepare for custom error messages, stored as HTML5 data on the error message display element\\\\n	var errormsg_element=(typeof the_element.name=='undefined')?null:get_errormsg_element(the_element.name);\\\\n\\\\n	// Blank?\\\\n	if ((required) && ((my_value.replace(/&nbsp;/g,' ').replace(/<br\\\\\\\\s*\\\\\\\\/?>/g,' ').replace(/\\\\\\\\s/g,'')=='') || (my_value=='****') || (my_value==the_element.alt)))\\\\n	{\\\\n		error_msg='\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"REQUIRED_NOT_FILLED_IN\\\",array()),\\n	\\\"';\\\\n		if ((errormsg_element) && (errormsg_element.getAttribute('data-errorUnfilled')!=null) && (errormsg_element.getAttribute('data-errorUnfilled')!=''))\\\\n			error_msg=errormsg_element.getAttribute('data-errorUnfilled');\\\\n	} else\\\\n	{\\\\n		// Standard field-type checks\\\\n		if ((the_element.className.indexOf('date')!=-1) && (the_element.name.match(/\\\\\\\\_(day|month|year)\\\\\\\$/)) && (my_value!=''))\\\\n		{\\\\n			var day=the_form.elements[the_element.name.replace(/\\\\\\\\_(day|month|year)\\\\\\\$/,'_day')].options[the_form.elements[the_element.name.replace(/\\\\\\\\_(day|month|year)\\\\\\\$/,'_day')].selectedIndex].value;\\\\n			var month=the_form.elements[the_element.name.replace(/\\\\\\\\_(day|month|year)\\\\\\\$/,'_month')].options[the_form.elements[the_element.name.replace(/\\\\\\\\_(day|month|year)\\\\\\\$/,'_month')].selectedIndex].value;\\\\n			var year=the_form.elements[the_element.name.replace(/\\\\\\\\_(day|month|year)\\\\\\\$/,'_year')].options[the_form.elements[the_element.name.replace(/\\\\\\\\_(day|month|year)\\\\\\\$/,'_year')].selectedIndex].value;\\\\n			var source_date=new Date(year,month-1,day);\\\\n			if (year!=source_date.getFullYear()) error_msg='\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"javascript:NOT_A_DATE\\\",array()),\\n	\\\"';\\\\n			if (month!=source_date.getMonth()+1) error_msg='\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"javascript:NOT_A_DATE\\\",array()),\\n	\\\"';\\\\n			if (day!=source_date.getDate()) error_msg='\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"javascript:NOT_A_DATE\\\",array()),\\n	\\\"';\\\\n		}\\\\n		if (((the_class=='input_email') || (the_class=='input_email_required')) && (my_value!='') && (!my_value.match(/^[a-zA-Z0-9\\\\\\\\._\\\\\\\\-\\\\\\\\+]+@[a-zA-Z0-9\\\\\\\\._\\\\\\\\-]+\\\\\\\$/)))\\\\n		{\\\\n			error_msg='\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"javascript:NOT_A_EMAIL\\\",array()),\\n	\\\"'.replace('{1}',my_value);\\\\n		}\\\\n		if (((the_class=='input_username') || (the_class=='input_username_required')) && (my_value!='') && (window.do_ajax_field_test) && (!do_ajax_field_test('\\\",\\n	ecv_FIND_SCRIPT_NOHTTP(\\\$cl,array(2),array(\\\"username_exists\\\")),\\n	\\\"?username='+encodeURIComponent(my_value))))\\\\n		{\\\\n			error_msg='\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"javascript:NOT_USERNAME\\\",array()),\\n	\\\"'.replace('{1}',my_value);\\\\n		}\\\\n		if (((the_class=='input_codename') || (the_class=='input_codename_required')) && (my_value!='') && (!my_value.match(/^[\\\",\\n	ecv(\\\$cl,array(),0,\\\"URL_CONTENT_REGEXP_JS\\\",array()),\\n	\\\"]*\\\\\\\$/)))\\\\n		{\\\\n			error_msg='\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"javascript:NOT_CODENAME\\\",array()),\\n	\\\"'.replace('{1}',my_value);\\\\n		}\\\\n		if (((the_class=='input_integer') || (the_class=='input_integer_required')) && (my_value!='') && (parseInt(my_value,10)!=my_value-0))\\\\n		{\\\\n			error_msg='\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"javascript:NOT_INTEGER\\\",array()),\\n	\\\"'.replace('{1}',my_value);\\\\n		}\\\\n		if (((the_class=='input_float') || (the_class=='input_float_required')) && (my_value!='') && (parseFloat(my_value)!=my_value-0))\\\\n		{\\\\n			error_msg='\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"javascript:NOT_FLOAT\\\",array()),\\n	\\\"'.replace('{1}',my_value);\\\\n		}\\\\n\\\\n		// Shim for HTML5 regexp patterns\\\\n		if (the_element.getAttribute('pattern'))\\\\n		{\\\\n			if ((my_value!='') && (!my_value.match(new RegExp(the_element.getAttribute('pattern')))))\\\\n			{\\\\n				error_msg='\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"javascript:PATTERN_NOT_MATCHED\\\",array()),\\n	\\\"'.replace('{1}',my_value);\\\\n			}\\\\n		}\\\\n\\\\n		// Custom error messages\\\\n		if (error_msg!='' && errormsg_element!=null)\\\\n		{\\\\n			var custom_msg=errormsg_element.getAttribute('data-errorRegexp');\\\\n			if ((custom_msg!=null) && (custom_msg!=''))\\\\n				error_msg=custom_msg;\\\\n		}\\\\n	}\\\\n\\\\n	// Show error?\\\\n	set_field_error(the_element,error_msg);\\\\n\\\\n	if ((error_msg!='') && (!erroneous))\\\\n	{\\\\n		erroneous=true;\\\\n	}\\\\n\\\\n	return [erroneous,total_file_size,alerted];\\\\n}\\\\n\\\\nfunction check_form(the_form,for_preview)\\\\n{\\\\n	var delete_element=document.getElementById('delete');\\\\n	if ((!for_preview) && (delete_element!=null) && (((first_class_name(delete_element.className)=='input_radio') && (delete_element.value!='0')) || (first_class_name(delete_element.className)=='input_tick')) && (delete_element.checked))\\\\n	{\\\\n		return true;\\\\n	}\\\\n\\\\n	var j,the_element,erroneous=false,total_file_size=0,alerted=false,error_element=null,check_result;\\\\n	for (j=0;j<the_form.elements.length;j++)\\\\n	{\\\\n		if (!the_form.elements[j]) continue;\\\\n\\\\n		if (the_form.elements[j].nodeName.toLowerCase()=='object') continue; // IE9 being weird!\\\\n\\\\n		the_element=the_form.elements[j];\\\\n\\\\n		check_result=check_field(the_element,the_form,for_preview);\\\\n		if (check_result!=null)\\\\n		{\\\\n			erroneous=check_result[0] || erroneous;\\\\n			if (!error_element && erroneous) error_element=the_element;\\\\n			total_file_size+=check_result[1];\\\\n			alerted=check_result[2] || alerted;\\\\n\\\\n			if (check_result[0])\\\\n			{\\\\n				var auto_reset_error=function(the_element) { return function(event,no_recurse) {\\\\n					var check_result=check_field(the_element,the_form,for_preview);\\\\n					if ((check_result!=null) && (!check_result[0]))\\\\n					{\\\\n						set_field_error(the_element,'');\\\\n					}\\\\n\\\\n					if ((!no_recurse) && (the_element.className.indexOf('date')!=-1) && (the_element.name.match(/\\\\\\\\_(day|month|year)\\\\\\\$/)))\\\\n					{\\\\n						var e=document.getElementById(the_element.id.replace(/\\\\\\\\_(day|month|year)\\\\\\\$/,'_day'));\\\\n						if (e!=the_element) e.onblur(event,true);\\\\n						var e=document.getElementById(the_element.id.replace(/\\\\\\\\_(day|month|year)\\\\\\\$/,'_month'));\\\\n						if (e!=the_element) e.onblur(event,true);\\\\n						var e=document.getElementById(the_element.id.replace(/\\\\\\\\_(day|month|year)\\\\\\\$/,'_year'));\\\\n						if (e!=the_element) e.onblur(event,true);\\\\n					}\\\\n				}; };\\\\n\\\\n				if (the_element.getAttribute('type')=='radio')\\\\n				{\\\\n					for (var i=0;i<the_form.elements.length;i++)\\\\n					{\\\\n						the_form.elements[i].onchange=auto_reset_error(the_form.elements[i]);\\\\n					}\\\\n				} else\\\\n				{\\\\n					the_element.onblur=auto_reset_error(the_element);\\\\n				}\\\\n			}\\\\n		}\\\\n	}\\\\n\\\\n	if ((total_file_size>0) && (the_form.elements['MAX_FILE_SIZE']))\\\\n	{\\\\n		if (total_file_size>the_form.elements['MAX_FILE_SIZE'].value)\\\\n		{\\\\n			if (!erroneous)\\\\n			{\\\\n				error_element=the_element;\\\\n				erroneous=true;\\\\n			}\\\\n			if (!alerted)\\\\n			{\\\\n				window.fauxmodal_alert('\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"javascript:TOO_MUCH_FILE_DATA\\\",array()),\\n	\\\"'.replace(new RegExp('\\\\\\\\\\\\\\\\\\\\\\\\{'+'1'+'\\\\\\\\\\\\\\\\\\\\\\\\}','g'),Math.round(total_file_size/1024)).replace(new RegExp('\\\\\\\\\\\\\\\\\\\\\\\\{'+'2'+'\\\\\\\\\\\\\\\\\\\\\\\\}','g'),Math.round(the_form.elements['MAX_FILE_SIZE'].value/1024)));\\\\n			}\\\\n			alerted=true;\\\\n		}\\\\n	}\\\\n\\\\n	if (erroneous)\\\\n	{\\\\n		if (!alerted) window.fauxmodal_alert('\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"IMPROPERLY_FILLED_IN\\\",array()),\\n	\\\"');\\\\n		var posy=find_pos_y(error_element,true);\\\\n		if (posy==0)\\\\n		{\\\\n			posy=find_pos_y(error_element.parentNode,true);\\\\n		}\\\\n		if (posy!=0)\\\\n			smooth_scroll(posy-50,null,null,function() { try { error_element.focus(); } catch(e) {} /* Can have exception giving focus on IE for invisible fields */ });\\\\n	}\\\\n\\\\n	// Try and workaround max_input_vars problem if lots of usergroups\\\\n	if (!erroneous)\\\\n	{\\\\n		var delete_e=document.getElementById('delete');\\\\n		var is_delete=delete_e && delete_e.type=='checkbox' && delete_e.checked;\\\\n		var es=document.getElementsByTagName('select'),e;\\\\n		for (var i=0;i<es.length;i++)\\\\n		{\\\\n			e=es[i];\\\\n			if ((e.name.match(/^access_\\\\\\\\d+_privilege_/)) && ((is_delete) || (e.options[e.selectedIndex].value=='-1')))\\\\n			{\\\\n				e.disabled=true;\\\\n			}\\\\n		}\\\\n	}\\\\n\\\\n	return !erroneous;\\\\n}\\\\n\\\\nfunction standard_alternate_fields_within(set_name,something_required)\\\\n{\\\\n	var form=document.getElementById('set_wrapper_'+set_name);\\\\n	while (form.nodeName.toLowerCase()!='form')\\\\n	{\\\\n		form=form.parentNode;\\\\n	}\\\\n	var fields=form.elements[set_name];\\\\n	var field_names=[];\\\\n	for (var i=0;i<fields.length;i++)\\\\n	{\\\\n		if (typeof fields[i][0]=='undefined')\\\\n		{\\\\n			if (fields[i].id.match(/^choose\\\\\\\\_/))\\\\n				field_names.push(fields[i].id.replace(/^choose\\\\\\\\_/,''));\\\\n		} else\\\\n		{\\\\n			if (fields[i][0].id.match(/^choose\\\\\\\\_/))\\\\n				field_names.push(fields[i][0].id.replace(/^choose\\\\\\\\_/,''));\\\\n		}\\\\n	}\\\\n	standard_alternate_fields(field_names,something_required);\\\\n}\\\\n\\\\n// Do dynamic set_locked/set_required such that one of these must be set, but only one may be\\\\nfunction standard_alternate_fields(field_names,something_required,second_run)\\\\n{\\\\n	if (typeof second_run=='undefined') second_run=false;\\\\n\\\\n	// Look up field objects\\\\n	var fields=[];\\\\n\\\\n	for (var i=0;i<field_names.length;i++)\\\\n	{\\\\n		var field=_standard_alternate_fields_get_object(field_names[i]);\\\\n		fields.push(field);\\\\n	}\\\\n\\\\n	// Set up listeners...\\\\n	for (var i=0;i<field_names.length;i++)\\\\n	{\\\\n		var field=fields[i];\\\\n		if ((!field) || (typeof field.alternating=='undefined')) // ... but only if not already set\\\\n		{\\\\n			var self_function=function (e) { standard_alternate_fields(field_names,something_required,true); } ; // We'll re-call ourself on change\\\\n			_standard_alternate_field_create_listeners(field,self_function);\\\\n		}\\\\n	}\\\\n\\\\n	// Update things\\\\n	for (var i=0;i<field_names.length;i++)\\\\n	{\\\\n		var field=fields[i];\\\\n		if (_standard_alternate_field_is_filled_in(field,second_run,false))\\\\n			return _standard_alternate_field_update_editability(field,fields,something_required);\\\\n	}\\\\n\\\\n	// Hmm, force first one chosen then\\\\n	for (var i=0;i<field_names.length;i++)\\\\n	{\\\\n		if (field_names[i]=='')\\\\n		{\\\\n			var radio_button=document.getElementById('choose_'); // Radio button handles field alternation\\\\n			radio_button.checked=true;\\\\n			return _standard_alternate_field_update_editability(null,fields,something_required);\\\\n		}\\\\n\\\\n		var field=fields[i];\\\\n		if ((field) && (_standard_alternate_field_is_filled_in(field,second_run,true)))\\\\n			return _standard_alternate_field_update_editability(field,fields,something_required);\\\\n	}\\\\n}\\\\n\\\\nfunction _standard_alternate_field_is_filled_in(field,second_run,force)\\\\n{\\\\n	if (!field) return false; // N/A input is considered unset\\\\n\\\\n	var is_set=force || ((field.value!='') && (field.value!='-1')) || ((typeof field.virtual_value!='undefined') && (field.virtual_value!='') && (field.virtual_value!='-1'));\\\\n\\\\n	var radio_button=document.getElementById('choose_'+(field?field.name:'').replace(/\\\\\\\\[\\\\\\\\]\\\\\\\$/,'')); // Radio button handles field alternation\\\\n	if (!radio_button) radio_button=document.getElementById('choose_'+field.name.replace(/\\\\\\\\_\\\\\\\\d+\\\\\\\$/,'_'));\\\\n	if (second_run)\\\\n	{\\\\n		if (radio_button) return radio_button.checked;\\\\n	} else\\\\n	{\\\\n		if (radio_button) radio_button.checked=is_set;\\\\n	}\\\\n	return is_set;\\\\n}\\\\n\\\\nfunction _standard_alternate_field_create_listeners(field,refreshFunction)\\\\n{\\\\n	if ((!field) || (typeof field.nodeName!='undefined'))\\\\n	{\\\\n		__standard_alternate_field_create_listeners(field,refreshFunction);\\\\n	} else\\\\n	{\\\\n		var i;\\\\n		for (i=0;i<field.length;i++)\\\\n		{\\\\n			if (typeof field[i].name!='undefined')\\\\n				__standard_alternate_field_create_listeners(field[i],refreshFunction);\\\\n		}\\\\n		field.alternating=true;\\\\n	}\\\\n	return null;\\\\n}\\\\n\\\\nfunction __standard_alternate_field_create_listeners(field,refreshFunction)\\\\n{\\\\n	var radio_button=document.getElementById('choose_'+(field?field.name:'').replace(/\\\\\\\\[\\\\\\\\]\\\\\\\$/,''));\\\\n	if (!radio_button) radio_button=document.getElementById('choose_'+field.name.replace(/\\\\\\\\_\\\\\\\\d+\\\\\\\$/,'_'));\\\\n	if (radio_button) // Radio button handles field alternation\\\\n	{\\\\n		add_event_listener_abstract(radio_button,'change',refreshFunction);\\\\n	} else // Filling/blanking out handles field alternation\\\\n	{\\\\n		if (field)\\\\n		{\\\\n			add_event_listener_abstract(field,'keyup',refreshFunction);\\\\n			add_event_listener_abstract(field,'change',refreshFunction);\\\\n			field.fakeonchange=refreshFunction;\\\\n		}\\\\n	}\\\\n	if (field) field.alternating=true;\\\\n}\\\\n\\\\nfunction _standard_alternate_fields_get_object(field_name)\\\\n{\\\\n	// Maybe it's an N/A so no actual field\\\\n	if (field_name=='') return null;\\\\n\\\\n	// Try and get direct field\\\\n	var field=document.getElementById(field_name);\\\\n	if (field) return field;\\\\n\\\\n	// A radio field, so we need to create a virtual field object to return that will hold our value\\\\n	var radio_buttons=[],i,j,e; /*JSLINT: Ignore errors*/\\\\n	radio_buttons['name']=field_name;\\\\n	radio_buttons['value']='';\\\\n	for (i=0;i<document.forms.length;i++)\\\\n	{\\\\n		for (j=0;j<document.forms[i].elements.length;j++)\\\\n		{\\\\n			e=document.forms[i].elements[j];\\\\n			if (!e.name) continue;\\\\n\\\\n			if ((e.name.replace(/\\\\\\\\[\\\\\\\\]\\\\\\\$/,'')==field_name) || (e.name.replace(/\\\\\\\\_\\\\\\\\d+\\\\\\\$/,'_')==field_name))\\\\n			{\\\\n				radio_buttons.push(e);\\\\n				if (e.checked) // This is the checked radio equivalent to our text field, copy the value through to the text field\\\\n				{\\\\n					radio_buttons['value']=e.value;\\\\n				}\\\\n				if (e.alternating) radio_buttons.alternating=true;\\\\n			}\\\\n		}\\\\n	}\\\\n\\\\n	if (radio_buttons.length==0) return null;\\\\n\\\\n	return radio_buttons;\\\\n}\\\\n\\\\nfunction _standard_alternate_field_update_editability(chosen,choices,something_required)\\\\n{\\\\n	for (var i=0;i<choices.length;i++)\\\\n	{\\\\n		__standard_alternate_field_update_editability(choices[i],chosen,choices[i]!=chosen,choices[i]==chosen,something_required);\\\\n	}\\\\n}\\\\n// NB: is_chosen may only be null if is_locked is false\\\\nfunction __standard_alternate_field_update_editability(field,chosen_field,is_locked,is_chosen,something_required)\\\\n{\\\\n	if ((!field) || (typeof field.nodeName!='undefined'))\\\\n	{\\\\n		___standard_alternate_field_update_editability(field,chosen_field,is_locked,is_chosen,something_required);\\\\n	} else // List of fields (e.g. radio list, or just because standard_alternate_fields_within was used)\\\\n	{\\\\n		for (var i=0;i<field.length;i++)\\\\n		{\\\\n			if (typeof field[i].name!='undefined') // If it is an object, as opposed to some string in the collection\\\\n			{\\\\n				___standard_alternate_field_update_editability(field[i],chosen_field,is_locked,is_chosen,something_required);\\\\n				something_required=false; // Only the first will be required\\\\n			}\\\\n		}\\\\n	}\\\\n}\\\\nfunction ___standard_alternate_field_update_editability(field,chosen_field,is_locked,is_chosen,something_required)\\\\n{\\\\n	if (!field) return;\\\\n\\\\n	var radio_button=document.getElementById('choose_'+field.name.replace(/\\\\\\\\[\\\\\\\\]\\\\\\\$/,''));\\\\n	if (!radio_button) radio_button=document.getElementById('choose_'+field.name.replace(/\\\\\\\\_\\\\\\\\d+\\\\\\\$/,'_'));\\\\n\\\\n	set_locked(field,is_locked,chosen_field);\\\\n	if (something_required)\\\\n	{\\\\n		set_required(field.name.replace(/\\\\\\\\[\\\\\\\\]\\\\\\\$/,''),is_chosen);\\\\n	}\\\\n}\\\\n\\\\nfunction set_locked(field,is_locked,chosen_ob)\\\\n{\\\\n	var radio_button=document.getElementById('choose_'+field.name.replace(/\\\\\\\\[\\\\\\\\]\\\\\\\$/,''));\\\\n	if (!radio_button) radio_button=document.getElementById('choose_'+field.name.replace(/\\\\\\\\_\\\\\\\\d+\\\\\\\$/,'_'));\\\\n\\\\n	// For All-and-not,Line-multi,Compound-Tick,Radio-List,Date/Time: set_locked assumes that the calling code is clever\\\\n	// special input types are coded to observe their master input field readonly status)\\\\n	var button=document.getElementById('uploadButton_'+field.name.replace(/\\\\\\\\[\\\\\\\\]\\\\\\\$/,''));\\\\n\\\\n	if (is_locked)\\\\n	{\\\\n		var labels=document.getElementsByTagName('label'),label=null;\\\\n		for (var i=0;i<labels.length;i++)\\\\n		{\\\\n			if ((chosen_ob) && (labels[i].getAttribute('for')==chosen_ob.id))\\\\n			{\\\\n				label=labels[i];\\\\n				break;\\\\n			}\\\\n		}\\\\n		if (!radio_button)\\\\n		{\\\\n			if (label)\\\\n			{\\\\n				var label_nice=get_inner_html(label).replace('&raquo;','').replace(/^\\\\\\\\s*/,'').replace(/\\\\\\\\s*\\\\\\\$/,'');\\\\n				if (field.type=='file')\\\\n				{\\\\n					set_field_error(field,'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"DISABLED_FORM_FIELD_ENCHANCEDMSG_UPLOAD\\\",array()),\\n	\\\"'.replace(/\\\\\\\\{1\\\\\\\\}/,label_nice));\\\\n				} else\\\\n				{\\\\n					set_field_error(field,'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"DISABLED_FORM_FIELD_ENCHANCEDMSG\\\",array()),\\n	\\\"'.replace(/\\\\\\\\{1\\\\\\\\}/,label_nice));\\\\n				}\\\\n			} else\\\\n			{\\\\n				set_field_error(field,'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"DISABLED_FORM_FIELD\\\",array()),\\n	\\\"');\\\\n			}\\\\n		}\\\\n		field.className=field.className.replace(/( input_erroneous(\\\\\\\$| ))+/g,' ');\\\\n	} else\\\\n	{\\\\n		if (!radio_button)\\\\n		{\\\\n			set_field_error(field,'');\\\\n		}\\\\n	}\\\\n	field.disabled=is_locked;\\\\n	if (button) button.disabled=is_locked;\\\\n}\\\\n\\\\nfunction set_required(field_name,is_required)\\\\n{\\\\n	var radio_button=document.getElementById('choose_'+field_name);\\\\n\\\\n	if (radio_button)\\\\n	{\\\\n		if (is_required) radio_button.checked=true;\\\\n	} else\\\\n	{\\\\n		var required_a=document.getElementById('form_table_field_name__'+field_name);\\\\n		var required_b=document.getElementById('required_readable_marker__'+field_name);\\\\n		var required_c=document.getElementById('required_posted__'+field_name);\\\\n		var required_d=document.getElementById('form_table_field_input__'+field_name);\\\\n		if (is_required)\\\\n		{\\\\n			if (required_a) required_a.className='form_table_field_name required';\\\\n			if (required_d) required_d.className='form_table_field_input';\\\\n			if (required_b) required_b.style.display='inline';\\\\n			if (required_c) required_c.value=1;\\\\n		} else\\\\n		{\\\\n			if (required_a) required_a.className='form_table_field_name';\\\\n			if (required_d) required_d.className='form_table_field_input';\\\\n			if (required_b) required_b.style.display='none';\\\\n			if (required_c) required_c.value=0;\\\\n		}\\\\n	}\\\\n\\\\n	var element=document.getElementById(field_name);\\\\n\\\\n	if (element)\\\\n	{\\\\n		element.className=element.className.replace(/(input\\\\\\\\_[a-z\\\\\\\\_]+)_required/g,'\\\\\\\$1');\\\\n\\\\n		if (typeof element.plupload_object!='undefined')\\\\n		{\\\\n			element.plupload_object.settings.required=is_required;\\\\n		}\\\\n\\\\n		if (is_required) element.className=element.className.replace(/(input\\\\\\\\_[a-z\\\\\\\\_]+)/g,'\\\\\\\$1_required');\\\\n	}\\\\n\\\\n	if (!is_required)\\\\n	{\\\\n		var error=document.getElementById('error__'+field_name);\\\\n		if (error) error.style.display='none';\\\\n	}\\\\n}\\\\n\\\\n// Hide a 'tray' of trs in a form\\\\nfunction toggle_subordinate_fields(pic,help_id)\\\\n{\\\\n	var new_state,new_state_2,new_state_3,i;\\\\n	var field_input=pic.parentNode.parentNode.parentNode;\\\\n\\\\n	var next=field_input.nextSibling;\\\\n	if (!next) return;\\\\n	while (element_has_class(next,'field_input')!==null) // Sometimes divs or whatever may have errornously been put in a table by a programmer, skip past them\\\\n	{\\\\n		next=next.nextSibling;\\\\n		if (!next) break;\\\\n		if (element_has_class(next,'form_table_field_spacer')) // End of section, so no need to keep going\\\\n		{\\\\n			next=null;\\\\n			break;\\\\n		}\\\\n	}\\\\n\\\\n	if (((!next) && (pic.src.indexOf('expand')!=-1)) || ((next) && (next.style.display=='none'))) /* Expanding now */\\\\n	{\\\\n		pic.src=((pic.src.indexOf('themewizard.php')!=-1)?pic.src.replace('expand','contract'):'\\\",\\n	ecv_IMG(\\\$cl,array(2),array(\\\"1x/trays/contract\\\",\\\"0\\\",\\\"BeatGrid_CSM\\\")),\\n	\\\"').replace(/^https?:/,window.location.protocol);\\\\n		if (typeof pic.srcset!='undefined')\\\\n			pic.srcset=((pic.srcset.indexOf('themewizard.php')!=-1)?pic.srcset.replace('expand','contract'):'\\\",\\n	ecv_IMG(\\\$cl,array(2),array(\\\"2x/trays/contract\\\",\\\"0\\\",\\\"BeatGrid_CSM\\\")),\\n	\\\" 2x').replace(/^https?:/,window.location.protocol);\\\\n		pic.setAttribute('alt','\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"CONTRACT\\\",array()),\\n	\\\"');\\\\n		pic.setAttribute('title','\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"CONTRACT\\\",array()),\\n	\\\"');\\\\n		new_state=(field_input.nodeName.toLowerCase()=='tr')?'table-row':'block';\\\\n		new_state_2='block';\\\\n		new_state_3='1px dashed';\\\\n	} else /* Contracting now */\\\\n	{\\\\n		pic.src=((pic.src.indexOf('themewizard.php')!=-1)?pic.src.replace('contract','expand'):'\\\",\\n	ecv_IMG(\\\$cl,array(2),array(\\\"1x/trays/expand\\\",\\\"0\\\",\\\"BeatGrid_CSM\\\")),\\n	\\\"').replace(/^https?:/,window.location.protocol);\\\\n		if (typeof pic.srcset!='undefined')\\\\n			pic.srcset=((pic.src.indexOf('themewizard.php')!=-1)?pic.srcset.replace('contract','expand'):'\\\",\\n	ecv_IMG(\\\$cl,array(2),array(\\\"2x/trays/expand\\\",\\\"0\\\",\\\"BeatGrid_CSM\\\")),\\n	\\\" 2x').replace(/^https?:/,window.location.protocol);\\\\n		pic.setAttribute('alt','\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"EXPAND\\\",array()),\\n	\\\"');\\\\n		pic.setAttribute('title','\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"EXPAND\\\",array()),\\n	\\\"');\\\\n		new_state='none';\\\\n		new_state_2='none';\\\\n		new_state_3='0';\\\\n	}\\\\n\\\\n	// Hide everything until we hit end of section\\\\n	var count=0;\\\\n	while (field_input.nextSibling!==null)\\\\n	{\\\\n		field_input=field_input.nextSibling;\\\\n		if (typeof field_input.className=='undefined') continue; // E.g. a #text node\\\\n\\\\n		/* Start of next section? */\\\\n		if (element_has_class(field_input,'form_table_field_spacer')) break; // End of section\\\\n\\\\n		/* Ok to proceed */\\\\n		field_input.style.display=new_state;\\\\n\\\\n		if ((typeof window.fade_transition!='undefined') && (new_state_2!='none') && (count<50/*Performance*/))\\\\n		{\\\\n			set_opacity(field_input,0.0);\\\\n			fade_transition(field_input,100,30,20);\\\\n			count++;\\\\n		}\\\\n	}\\\\n	if (typeof help_id=='undefined') help_id=pic.parentNode.id+'_help';\\\\n	var help=document.getElementById(help_id);\\\\n	while (help!==null)\\\\n	{\\\\n		help.style.display=new_state_2;\\\\n		help=help.nextSibling;\\\\n		if ((help) && (help.nodeName.toLowerCase()!='p')) break;\\\\n	}\\\\n\\\\n	trigger_resize();\\\\n}\\\\n\\\\nfunction initialise_input_theme_image_entry(name,code)\\\\n{\\\\n	var stem=name+'_'+code;\\\\n\\\\n	var e=document.getElementById('w_'+stem);\\\\n	var img=e.getElementsByTagName('img')[0];\\\\n	var input=document.getElementById('j_'+stem);\\\\n	var label=e.getElementsByTagName('label')[0];\\\\n	var form=input.form;\\\\n\\\\n	e.onkeypress=function(event) {\\\\n		if (!event) event=window.event;\\\\n\\\\n		if (entered_pressed(event))\\\\n			return e.onclick.call([event]);\\\\n		return null;\\\\n	};\\\\n\\\\n	var click_func=function(event) {\\\\n		if (!event) event=window.event;\\\\n\\\\n		choose_picture('j_'+stem,img,name,event);\\\\n\\\\n		if (typeof window.main_form_very_simple!='undefined') form.submit();\\\\n\\\\n		cancel_bubbling(event);\\\\n	}\\\\n	img.onkeypress=click_func;\\\\n	img.onclick=click_func;\\\\n	e.onclick=click_func;\\\\n\\\\n	label.className='js_widget';\\\\n\\\\n	input.onclick=function() {\\\\n		if (this.disabled) return;\\\\n		if (typeof window.deselect_alt_url!='undefined') deselect_alt_url(this.form);\\\\n		if (typeof window.main_form_very_simple!='undefined') this.form.submit();\\\\n		cancel_bubbling(event);\\\\n	}\\\\n}\\\\n\\\\nfunction choose_picture(j_id,img_ob,name,event)\\\\n{\\\\n	var j=document.getElementById(j_id);\\\\n	if (!j) return;\\\\n\\\\n	if (!img_ob)\\\\n	{\\\\n		img_ob=document.getElementById('w_'+j_id.substring(2,j_id.length)).getElementsByTagName('img')[0];\\\\n		if (typeof img_ob=='undefined') return;\\\\n	}\\\\n\\\\n	var e=j.form.elements[name];\\\\n	for (var i=0;i<e.length;i++)\\\\n	{\\\\n		if (e[i].disabled) continue;\\\\n		var img=e[i].parentNode.parentNode.getElementsByTagName('img')[0];\\\\n		if ((img) && (img!=img_ob))\\\\n		{\\\\n			if (img.parentNode.className.indexOf(' selected')!=-1)\\\\n			{\\\\n				img.parentNode.className=img.parentNode.className.replace(/ selected/g,'');\\\\n				img.style.outline='0';\\\\n				if (!browser_matches('ie8+')) img.style.background='none';\\\\n			}\\\\n		}\\\\n	}\\\\n\\\\n	if (j.disabled) return;\\\\n	j.checked=true;\\\\n	//if (j.onclick) j.onclick(); causes loop\\\\n	if (typeof j.fakeonchange!='undefined' && j.fakeonchange) j.fakeonchange(event);\\\\n	img_ob.parentNode.className+=' selected';\\\\n	img_ob.style.outline='1px dotted';\\\\n}\\\\n\\\\nfunction preview_mobile_button(ob,event)\\\\n{\\\\n	if (!event) event=window.event;\\\\n\\\\n	ob.form.action=ob.form.action.replace(/keep_mobile=\\\\\\\\d/g,'keep_mobile='+(ob.checked?'1':'0'));\\\\n	if (window.parent)\\\\n	{\\\\n		try {\\\\n			window.parent.scrollTo(0,find_pos_y(window.parent.document.getElementById('preview_iframe')));\\\\n		}\\\\n		catch(e) {}\\\\n		window.parent.mobile_version_for_preview=ob.checked;\\\\n		window.parent.document.getElementById('preview_button').onclick(event);\\\\n		return false;\\\\n	}\\\\n	ob.form.submit();\\\\n	return false;\\\\n}\\\\n\\\\nfunction disable_preview_scripts(under)\\\\n{\\\\n	if (typeof under=='undefined') under=document;\\\\n\\\\n	var elements,i;\\\\n	var no_go=function() {\\\\n		window.fauxmodal_alert('\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"NOT_IN_PREVIEW_MODE\\\",array()),\\n	\\\"');\\\\n		return false;\\\\n	};\\\\n	elements=under.getElementsByTagName('button');\\\\n	for (i=0;i<elements.length;i++)\\\\n		elements[i].onclick=no_go;\\\\n	elements=under.getElementsByTagName('input');\\\\n	for (i=0;i<elements.length;i++)\\\\n		if ((elements[i].getAttribute('type')=='button') || (elements[i].getAttribute('type')=='image')) elements[i].onclick=no_go;\\\\n	// Make sure links in the preview don't break it - put in a new window\\\\n	elements=under.getElementsByTagName('a');\\\\n	for (i=0;i<elements.length;i++)\\\\n	{\\\\n		if (elements[i].href.indexOf('://')!=-1)\\\\n		{\\\\n			try\\\\n			{\\\\n				if (((!elements[i].href) || (elements[i].href.toLowerCase().indexOf('javascript:')!=0)) && (elements[i].target!=='_self') && (elements[i].target!=='_blank')) // guard due to weird Firefox bug, JS actions still opening new window\\\\n				{\\\\n					elements[i].target='false_blank'; // Real _blank would trigger annoying CSS. This is better anyway.\\\\n				}\\\\n			}\\\\n			catch (e) {}; // IE can have security exceptions\\\\n		}\\\\n	}\\\\n}\\\\n\\\\nfunction _set_up_change_monitor(container,input,container2)\\\\n{\\\\n	var elements=[];\\\\n	if (input)\\\\n	{\\\\n		elements=[document.getElementById(input)];\\\\n	} else\\\\n	{\\\\n		elements=get_all_form_elements(container);\\\\n	}\\\\n	if (elements.length>300) return;\\\\n	for (var i=0;i<elements.length;i++)\\\\n	{\\\\n		if (!elements[i]) continue;\\\\n		if ((typeof elements[0]=='undefined') || (elements[0].id.indexOf('choose_')!=-1)) continue;\\\\n		var func=function() {\\\\n			if (find_if_children_set(input?document.getElementById(input).parentNode:container))\\\\n			{\\\\n				if (container.className.indexOf(' filledin')==-1) container.className+=' filledin';\\\\n				if (container2) if (container2.className.indexOf(' filledin')==-1) container2.className+=' filledin';\\\\n			} else\\\\n			{\\\\n				container.className=container.className.replace(/ filledin\\\\\\\$/,'');\\\\n				if (container2) container2.className=container2.className.replace(/ filledin\\\\\\\$/,'');\\\\n			}\\\\n		};\\\\n		add_event_listener_abstract(elements[i],'blur',func );\\\\n		add_event_listener_abstract(elements[i],'change',func );\\\\n	}\\\\n}\\\\n\\\\nfunction find_if_children_set(container)\\\\n{\\\\n	var value,blank=true,the_element;\\\\n	var elements=get_all_form_elements(container);\\\\n	for (var i=0;i<elements.length;i++)\\\\n	{\\\\n		if (!elements[i]) continue;\\\\n		the_element=elements[i];\\\\n		if (((the_element.type=='hidden') || ((the_element.style.display=='none') && ((typeof window.is_wysiwyg_field=='undefined') || (!is_wysiwyg_field(the_element))))) && ((!the_element.className) || (!element_has_class(the_element,'hidden_but_needed')))) continue;\\\\n		value=clever_find_value(the_element.form,the_element);\\\\n		blank=blank && (value=='');\\\\n	}\\\\n	return !blank;\\\\n}\\\\n\\\\nfunction get_all_form_elements(container)\\\\n{\\\\n	var i;\\\\n	var elements1=container.getElementsByTagName('input');\\\\n	var elements2=container.getElementsByTagName('select');\\\\n	var elements3=container.getElementsByTagName('textarea');\\\\n	var elements=[];\\\\n	for (i=0;i<elements1.length;i++) elements.push(elements1[i]);\\\\n	for (i=0;i<elements2.length;i++) elements.push(elements2[i]);\\\\n	for (i=0;i<elements3.length;i++) elements.push(elements3[i]);\\\\n	return elements;\\\\n}\\\\n\\\\nfunction assign_tick_deletion_confirm(name)\\\\n{\\\\n	document.getElementById(name).onchange=function()\\\\n	{\\\\n		if (this.checked)\\\\n		{\\\\n			window.fauxmodal_confirm(\\\\n				'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"ARE_YOU_SURE_DELETE\\\",array()),\\n	\\\"',\\\\n				function(result)\\\\n				{\\\\n					var e=document.getElementById(name);\\\\n					if (e)\\\\n					{\\\\n						if (result)\\\\n						{\\\\n							var form=e.form;\\\\n							if (form.action.indexOf('_post')==-1) // Remove redirect if redirecting back, IF it's not just deleting an on-page post (Wiki+)\\\\n								form.action=form.action.replace(/([&\\\\\\\\?])redirect=[^&]*/,'\\\\\\\$1');\\\\n						} else\\\\n						{\\\\n							e.checked=false;\\\\n						}\\\\n					}\\\\n				}\\\\n			);\\\\n		}\\\\n	}\\\\n}\\\\n\\\\nfunction assign_radio_deletion_confirm(name)\\\\n{\\\\n	for (var i=1;i<3;i++)\\\\n	{\\\\n		var e=document.getElementById('j_'+name+'_'+i);\\\\n		if (e)\\\\n		{\\\\n			e.onchange=function()\\\\n			{\\\\n				if (this.checked)\\\\n				{\\\\n					window.fauxmodal_confirm(\\\\n						'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"ARE_YOU_SURE_DELETE\\\",array()),\\n	\\\"',\\\\n						function(result)\\\\n						{\\\\n							var e=document.getElementById('j_'+name+'_0');\\\\n							if (e)\\\\n							{\\\\n								if (result)\\\\n								{\\\\n									var form=e.form;\\\\n									form.action=form.action.replace(/([&\\\\\\\\?])redirect=[^&]*/,'\\\\\\\$1');\\\\n								} else\\\\n								{\\\\n									e.checked=true; // Check first radio\\\\n								}\\\\n							}\\\\n						}\\\\n					);\\\\n				}\\\\n			}\\\\n		}\\\\n	}\\\\n}\\\\n\\\\n/* Geolocation for address fields */\\\\nfunction geolocate_address_fields()\\\\n{\\\\n	if (typeof navigator.geolocation!='undefined')\\\\n	{\\\\n		try\\\\n		{\\\\n			navigator.geolocation.getCurrentPosition(function(position) {\\\\n				var fields=[\\\\n					'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"cns_special_cpf:SPECIAL_CPF__cms_street_address\\\",array()),\\n	\\\"',\\\\n					'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"cns_special_cpf:SPECIAL_CPF__cms_city\\\",array()),\\n	\\\"',\\\\n					'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"cns_special_cpf:SPECIAL_CPF__cms_county\\\",array()),\\n	\\\"',\\\\n					'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"cns_special_cpf:SPECIAL_CPF__cms_state\\\",array()),\\n	\\\"',\\\\n					'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"cns_special_cpf:SPECIAL_CPF__cms_post_code\\\",array()),\\n	\\\"',\\\\n					'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"cns_special_cpf:SPECIAL_CPF__cms_country\\\",array()),\\n	\\\"'\\\\n				];\\\\n\\\\n				var geocode_url='\\\",\\n	ecv_FIND_SCRIPT(\\\$cl,array(2),array(\\\"geocode\\\")),\\n	\\\"';\\\\n				geocode_url+='?latitude='+window.encodeURIComponent(position.coords.latitude)+'&longitude='+window.encodeURIComponent(position.coords.longitude);\\\\n				geocode_url+=keep_stub();\\\\n\\\\n				do_ajax_request(geocode_url,function(ajax_result) {\\\\n					var parsed=JSON.parse(ajax_result.responseText);\\\\n					if (parsed===null) return;\\\\n					var labels=document.getElementsByTagName('label'),label,field_name,field;\\\\n					for (var i=0;i<labels.length;i++)\\\\n					{\\\\n						label=get_inner_html(labels[i]);\\\\n						for (var j=0;j<fields.length;j++)\\\\n						{\\\\n							if (fields[j].replace(/^.*: /,'')==label)\\\\n							{\\\\n								if (parsed[j+1]===null) parsed[j+1]='';\\\\n\\\\n								field_name=labels[i].getAttribute('for');\\\\n								field=document.getElementById(field_name);\\\\n								if (field.nodeName.toLowerCase()=='select')\\\\n								{\\\\n									field.value=parsed[j+1];\\\\n									if (typeof \\\\\\\$(field).select2!='undefined') {\\\\n										\\\\\\\$(field).trigger('change');\\\\n									}\\\\n								} else\\\\n								{\\\\n									field.value=parsed[j+1];\\\\n								}\\\\n							}\\\\n						}\\\\n					}\\\\n				});\\\\n			});\\\\n		}\\\\n		catch (e) {}\\\\n	}\\\\n}\\\\n\\\";\");\";}}");

