<?php
return unserialize("a:5:{i:0;a:1:{i:0;a:1:{i:0;a:5:{i:0;s:33:\"tcpfunc_5abfcf2f0f1e36.74973417_1\";i:1;a:0:{}i:2;i:1;i:3;s:0:\"\";i:4;s:0:\"\";}}}i:1;a:0:{}i:2;s:4:\"ajax\";i:3;N;i:4;a:1:{s:33:\"tcpfunc_5abfcf2f0f1e36.74973417_1\";s:25577:\"\$tpl_funcs['tcpfunc_5abfcf2f0f1e36.74973417_1']=\$KEEP_TPL_FUNCS['tcpfunc_5abfcf2f0f1e36.74973417_1']=recall_named_function('5abfcf2f0f2071.01821988','\$parameters,\$cl',\"echo \\\"\\\\\\\"use strict\\\\\\\";\\\\n\\\\nif (typeof window.AJAX_REQUESTS=='undefined')\\\\n{\\\\n	window.AJAX_REQUESTS=[];\\\\n	window.AJAX_METHODS=[];\\\\n}\\\\n\\\\n/*\\\\n	Faux frames and faux scrolling\\\\n*/\\\\n\\\\nif (typeof window.block_data_cache=='undefined')\\\\n{\\\\n	window.block_data_cache={};\\\\n}\\\\n\\\\nif (typeof window.infinite_scroll_pending=='undefined')\\\\n{\\\\n	window.infinite_scroll_pending=false; // Blocked due to queued HTTP request\\\\n	window.infinite_scroll_blocked=false; // Blocked due to event tracking active\\\\n}\\\\nfunction infinite_scrolling_block(event)\\\\n{\\\\n	if (event.keyCode==35) // 'End' key pressed, so stop the expand happening for a few seconds while the browser scrolls down\\\\n	{\\\\n		window.infinite_scroll_blocked=true;\\\\n		window.setTimeout(function() {\\\\n			window.infinite_scroll_blocked=false;\\\\n		}, 3000);\\\\n	}\\\\n}\\\\nif (typeof window.infinite_scroll_mouse_held=='undefined')\\\\n{\\\\n	window.infinite_scroll_mouse_held=false;\\\\n}\\\\nfunction infinite_scrolling_block_hold()\\\\n{\\\\n	if (!window.infinite_scroll_blocked)\\\\n	{\\\\n		window.infinite_scroll_blocked=true;\\\\n		window.infinite_scroll_mouse_held=true;\\\\n	}\\\\n}\\\\nfunction infinite_scrolling_block_unhold(infinite_scrolling)\\\\n{\\\\n	if (window.infinite_scroll_mouse_held)\\\\n	{\\\\n		window.infinite_scroll_blocked=false;\\\\n		window.infinite_scroll_mouse_held=false;\\\\n		infinite_scrolling();\\\\n	}\\\\n}\\\\nfunction internalise_infinite_scrolling(url_stem,wrapper)\\\\n{\\\\n	if (window.infinite_scroll_blocked || window.infinite_scroll_pending) return false; // Already waiting for a result\\\\n\\\\n	var _pagination=get_elements_by_class_name(wrapper,'pagination');\\\\n\\\\n	if (_pagination.length==0) return false;\\\\n\\\\n	var more_links=[],found_new_links=null;\\\\n\\\\n	for (var _i=0;_i<_pagination.length;_i++)\\\\n	{\\\\n		var pagination=_pagination[_i];\\\\n\\\\n		if (pagination.style.display!='none')\\\\n		{\\\\n			// Remove visibility of pagination, now we've replaced with AJAX load more link\\\\n			var pagination_parent=pagination.parentNode;\\\\n			pagination.style.display='none';\\\\n			var num_node_children=0;\\\\n			for (var i=0;i<pagination_parent.childNodes.length;i++)\\\\n			{\\\\n				if (pagination_parent.childNodes[i].nodeName!='#text') num_node_children++;\\\\n			}\\\\n			if (num_node_children==0) // Remove empty pagination wrapper\\\\n			{\\\\n				pagination_parent.style.display='none';\\\\n			}\\\\n\\\\n			// Add AJAX load more link before where the last pagination control was\\\\n				// Remove old pagination_load_more's\\\\n				var pagination_load_more=get_elements_by_class_name(wrapper,'pagination_load_more');\\\\n				if (pagination_load_more.length>0) pagination_load_more[0].parentNode.removeChild(pagination_load_more[0]);\\\\n\\\\n				// Add in new one\\\\n				var load_more_link=document.createElement('div');\\\\n				load_more_link.className='pagination_load_more';\\\\n				var load_more_link_a=document.createElement('a');\\\\n				set_inner_html(load_more_link_a,'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"LOAD_MORE\\\",array()),\\n	\\\"');\\\\n				load_more_link_a.href='#';\\\\n				load_more_link_a.onclick=function() { internalise_infinite_scrolling_go(url_stem,wrapper,more_links); return false; }; // Click link -- load\\\\n				load_more_link.appendChild(load_more_link_a);\\\\n				_pagination[_pagination.length-1].parentNode.insertBefore(load_more_link,_pagination[_pagination.length-1].nextSibling);\\\\n\\\\n			more_links=pagination.getElementsByTagName('a');\\\\n			found_new_links=_i;\\\\n		}\\\\n	}\\\\n	for (var _i=0;_i<_pagination.length;_i++)\\\\n	{\\\\n		var pagination=_pagination[_i];\\\\n		if (found_new_links!=null) // Cleanup old pagination\\\\n		{\\\\n			if (_i!=found_new_links)\\\\n			{\\\\n				var _more_links=pagination.getElementsByTagName('a');\\\\n				var num_links=_more_links.length;\\\\n				for (var i=num_links-1;i>=0;i--)\\\\n				{\\\\n					_more_links[i].parentNode.removeChild(_more_links[i]);\\\\n				}\\\\n			}\\\\n		} else // Find links from an already-hidden pagination\\\\n		{\\\\n			more_links=pagination.getElementsByTagName('a');\\\\n			if (more_links.length!=0) break;\\\\n		}\\\\n	}\\\\n\\\\n	// Is more scrolling possible?\\\\n	var rel,found_rel=false;\\\\n	for (var i=0;i<more_links.length;i++)\\\\n	{\\\\n		rel=more_links[i].getAttribute('rel');\\\\n		if (rel && rel.indexOf('next')!=-1)\\\\n		{\\\\n			found_rel=true;\\\\n		}\\\\n	}\\\\n	if (!found_rel) // Ah, no more scrolling possible\\\\n	{\\\\n		// Remove old pagination_load_more's\\\\n		var pagination_load_more=get_elements_by_class_name(wrapper,'pagination_load_more');\\\\n		if (pagination_load_more.length>0) pagination_load_more[0].parentNode.removeChild(pagination_load_more[0]);\\\\n\\\\n		return;\\\\n	}\\\\n\\\\n	// Used for calculating if we need to scroll down\\\\n	var wrapper_pos_y=find_pos_y(wrapper);\\\\n	var wrapper_height=find_height(wrapper);\\\\n	var wrapper_bottom=wrapper_pos_y+wrapper_height;\\\\n	var window_height=get_window_height();\\\\n	var page_height=get_window_scroll_height();\\\\n	var scroll_y=get_window_scroll_y();\\\\n\\\\n	// Scroll down -- load\\\\n	if ((scroll_y+window_height>wrapper_bottom-window_height*2) && (scroll_y+window_height<page_height-30)) // If within window_height*2 pixels of load area and not within 30 pixels of window bottom (so you can press End key)\\\\n	{\\\\n		return internalise_infinite_scrolling_go(url_stem,wrapper,more_links);\\\\n	}\\\\n\\\\n	return false;\\\\n}\\\\nfunction internalise_infinite_scrolling_go(url_stem,wrapper,more_links)\\\\n{\\\\n	if (window.infinite_scroll_pending) return false;\\\\n\\\\n	var wrapper_inner=document.getElementById(wrapper.id+'_inner');\\\\n	if (!wrapper_inner) wrapper_inner=wrapper;\\\\n\\\\n	var rel;\\\\n	for (var i=0;i<more_links.length;i++)\\\\n	{\\\\n		rel=more_links[i].getAttribute('rel');\\\\n		if (rel && rel.indexOf('next')!=-1)\\\\n		{\\\\n			var next_link=more_links[i];\\\\n			var url_stub='';\\\\n\\\\n			var matches=next_link.href.match(new RegExp('[&?](start|[^_]*_start|start_[^_]*)=([^&]*)'));\\\\n			if (matches)\\\\n			{\\\\n				url_stub+=(url_stem.indexOf('?')==-1)?'?':'&';\\\\n				url_stub+=matches[1]+'='+matches[2];\\\\n				url_stub+='&raw=1';\\\\n				window.infinite_scroll_pending=true;\\\\n\\\\n				return call_block(url_stem+url_stub,'',wrapper_inner,true,function() { window.infinite_scroll_pending=false; internalise_infinite_scrolling(url_stem,wrapper); });\\\\n			}\\\\n		}\\\\n	}\\\\n\\\\n	return false;\\\\n}\\\\n\\\\nfunction internalise_ajax_block_wrapper_links(url_stem,block_element,look_for,extra_params,append,forms_too,scroll_to_top)\\\\n{\\\\n	if (!block_element) return;\\\\n\\\\n	if (typeof look_for=='undefined') look_for=[];\\\\n	if (typeof extra_params=='undefined') extra_params=[];\\\\n	if (typeof append=='undefined') append=false;\\\\n	if (typeof forms_too=='undefined') forms_too=false;\\\\n	if (typeof scroll_to_top=='undefined') scroll_to_top=true;\\\\n\\\\n	var block_pos_y=find_pos_y(block_element,true);\\\\n	if (block_pos_y>get_window_scroll_y()) {\\\\n		scroll_to_top=false;\\\\n	}\\\\n\\\\n	var _link_wrappers=get_elements_by_class_name(block_element,'ajax_block_wrapper_links');\\\\n	if (_link_wrappers.length==0) _link_wrappers=[block_element];\\\\n	var links=[];\\\\n	for (var i=0;i<_link_wrappers.length;i++)\\\\n	{\\\\n		var _links=_link_wrappers[i].getElementsByTagName('a');\\\\n		for (var j=0;j<_links.length;j++)\\\\n			links.push(_links[j]);\\\\n		if (forms_too)\\\\n		{\\\\n			_links=_link_wrappers[i].getElementsByTagName('form');\\\\n			for (var j=0;j<_links.length;j++)\\\\n				links.push(_links[j]);\\\\n			if (_link_wrappers[i].nodeName.toLowerCase()=='form')\\\\n				links.push(_link_wrappers[i]);\\\\n		}\\\\n	}\\\\n	for (var i=0;i<links.length;i++)\\\\n	{\\\\n		if ((links[i].target) && (links[i].target=='_self') && ((!links[i].href) || (links[i].href.substr(0,1)!='#')))\\\\n		{\\\\n			var submit_func=function()\\\\n			{\\\\n				var url_stub='';\\\\n\\\\n				var href=(this.nodeName.toLowerCase()=='a')?this.href:this.action;\\\\n\\\\n				// Any parameters matching a pattern must be sent in the URL to the AJAX block call\\\\n				for (var j=0;j<look_for.length;j++)\\\\n				{\\\\n					var matches=href.match(new RegExp('[&\\\\\\\\?]('+look_for[j]+')=([^&]*)'));\\\\n					if (matches)\\\\n					{\\\\n						url_stub+=(url_stem.indexOf('?')==-1)?'?':'&';\\\\n						url_stub+=matches[1]+'='+matches[2];\\\\n					}\\\\n				}\\\\n				for (var j in extra_params)\\\\n				{\\\\n					url_stub+=(url_stem.indexOf('?')==-1)?'?':'&';\\\\n					url_stub+=j+'='+window.encodeURIComponent(extra_params[j]);\\\\n				}\\\\n\\\\n				// Any POST parameters?\\\\n				var post_params=null,param;\\\\n				if (this.nodeName.toLowerCase()=='form')\\\\n				{\\\\n					post_params='';\\\\n					for (var j=0;j<this.elements.length;j++)\\\\n					{\\\\n						if (this.elements[j].name)\\\\n						{\\\\n							param=this.elements[j].name+'='+window.encodeURIComponent(clever_find_value(this,this.elements[j]));\\\\n\\\\n							if ((!this.method) || (this.method.toLowerCase()!='get'))\\\\n							{\\\\n								if (post_params!='') post_params+='&';\\\\n								post_params+=param;\\\\n							} else\\\\n							{\\\\n								url_stub+=(url_stem.indexOf('?')==-1)?'?':'&';\\\\n								url_stub+=param;\\\\n							}\\\\n						}\\\\n					}\\\\n				}\\\\n\\\\n				if (typeof window.history.pushState!='undefined')\\\\n				{\\\\n					try\\\\n					{\\\\n						window.has_js_state=true;\\\\n						history.pushState({js: true},document.title,href.replace('&ajax=1','').replace(/&zone=[\\\",\\n	ecv(\\\$cl,array(),0,\\\"URL_CONTENT_REGEXP_JS\\\",array()),\\n	\\\"]+/,''));\\\\n					}\\\\n					catch (e) {}; // Exception could have occurred due to cross-origin error (e.g. \\\\\\\"Failed to execute 'pushState' on 'History': A history state object with URL 'https://xxx' cannot be created in a document with origin 'http://xxx'\\\\\\\")\\\\n				}\\\\n\\\\n				clear_out_tooltips(null);\\\\n\\\\n				// Make AJAX block call\\\\n				return call_block(url_stem+url_stub,'',block_element,append,function() { if (scroll_to_top) window.scrollTo(0,block_pos_y); },false,post_params);\\\\n			};\\\\n			if (links[i].nodeName.toLowerCase()=='a')\\\\n			{\\\\n				if (links[i].onclick)\\\\n				{\\\\n					links[i].onclick=function(old_onclick) { return function(event) { return old_onclick.call(this,event)!==false && submit_func.call(this,event); } }(links[i].onclick);\\\\n				} else\\\\n				{\\\\n					links[i].onclick=submit_func;\\\\n				}\\\\n			} else\\\\n			{\\\\n				if (links[i].onsubmit)\\\\n				{\\\\n					links[i].onsubmit=function(old_onsubmit) { return function(event) { return old_onsubmit.call(this,event)!==false && submit_func.call(this,event); } }(links[i].onsubmit);\\\\n				} else\\\\n				{\\\\n					links[i].onsubmit=submit_func;\\\\n				}\\\\n			}\\\\n		}\\\\n	}\\\\n}\\\\n\\\\nfunction guarded_form_submit(form)\\\\n{\\\\n	if ((!form.onsubmit) || (form.onsubmit())) form.submit();\\\\n}\\\\n\\\\n// This function will load a block, with options for parameter changes, and render the results in specified way - with optional callback support\\\\nfunction call_block(url,new_block_params,target_div,append,callback,scroll_to_top_of_wrapper,post_params,inner,show_loading_animation)\\\\n{\\\\n	if (typeof scroll_to_top_of_wrapper=='undefined') scroll_to_top_of_wrapper=false;\\\\n	if (typeof post_params=='undefined') post_params=null;\\\\n	if (typeof inner=='undefined') inner=false;\\\\n	if (typeof show_loading_animation=='undefined') show_loading_animation=true;\\\\n	if ((typeof block_data_cache[url]=='undefined') && (new_block_params!=''))\\\\n		block_data_cache[url]=get_inner_html(target_div); // Cache start position. For this to be useful we must be smart enough to pass blank new_block_params if returning to fresh state\\\\n\\\\n	var ajax_url=url;\\\\n	if (new_block_params!='') ajax_url+='&block_map_sup='+window.encodeURIComponent(new_block_params);\\\\n	if (typeof window.cms_theme!='undefined') ajax_url+='&utheme='+window.cms_theme;\\\\n	if (typeof block_data_cache[ajax_url]!='undefined' && post_params==null)\\\\n	{\\\\n		// Show results from cache\\\\n		show_block_html(block_data_cache[ajax_url],target_div,append,inner);\\\\n		if (callback) callback();\\\\n		return false;\\\\n	}\\\\n\\\\n	// Show loading animation\\\\n	var loading_wrapper=target_div;\\\\n	if ((loading_wrapper.id.indexOf('carousel_')==-1) && (get_inner_html(loading_wrapper).indexOf('ajax_loading_block')==-1) && (show_loading_animation))\\\\n	{\\\\n		var raw_ajax_grow_spot=get_elements_by_class_name(target_div,'raw_ajax_grow_spot');\\\\n		if (typeof raw_ajax_grow_spot[0]!='undefined' && append) loading_wrapper=raw_ajax_grow_spot[0]; // If we actually are embedding new results a bit deeper\\\\n		var loading_wrapper_inner=document.createElement('div');\\\\n		var position_type=abstract_get_computed_style(loading_wrapper,'position');\\\\n		if ((position_type!='relative') && (position_type!='absolute'))\\\\n		{\\\\n			if (append)\\\\n			{\\\\n				loading_wrapper_inner.style.position='relative';\\\\n			} else\\\\n			{\\\\n				loading_wrapper.style.position='relative';\\\\n			}\\\\n		}\\\\n		var loading_image=document.createElement('img');\\\\n		loading_image.className='ajax_loading_block';\\\\n		loading_image.src='\\\",\\n	ecv_IMG(\\\$cl,array(2),array(\\\"loading\\\",\\\"0\\\",\\\"BeatGrid_CSM\\\")),\\n	\\\"'.replace(/^https?:/,window.location.protocol);\\\\n		loading_image.style.position='absolute';\\\\n		loading_image.style.zIndex='1000';\\\\n		loading_image.style.left=(find_width(target_div)/2-10)+'px';\\\\n		if (!append)\\\\n		{\\\\n			loading_image.style.top=(find_height(target_div)/2-20)+'px';\\\\n		} else\\\\n		{\\\\n			loading_image.style.top=0;\\\\n			loading_wrapper_inner.style.height='30px';\\\\n		}\\\\n		loading_wrapper_inner.appendChild(loading_image);\\\\n		loading_wrapper.appendChild(loading_wrapper_inner);\\\\n		window.document.body.style.cursor='wait';\\\\n	}\\\\n\\\\n	// Make AJAX call\\\\n	do_ajax_request(\\\\n		ajax_url+keep_stub(),\\\\n		function(raw_ajax_result) { // Show results when available\\\\n			_call_block_render(raw_ajax_result,ajax_url,target_div,append,callback,scroll_to_top_of_wrapper,inner);\\\\n		},\\\\n		post_params\\\\n	);\\\\n\\\\n	return false;\\\\n}\\\\n\\\\nfunction _call_block_render(raw_ajax_result,ajax_url,target_div,append,callback,scroll_to_top_of_wrapper,inner)\\\\n{\\\\n	var new_html=raw_ajax_result.responseText;\\\\n	block_data_cache[ajax_url]=new_html;\\\\n\\\\n	// Remove loading animation if there is one\\\\n	var ajax_loading=get_elements_by_class_name(target_div,'ajax_loading_block');\\\\n	if (typeof ajax_loading[0]!='undefined')\\\\n	{\\\\n		ajax_loading[0].parentNode.parentNode.removeChild(ajax_loading[0].parentNode);\\\\n	}\\\\n	window.document.body.style.cursor='';\\\\n\\\\n	// Put in HTML\\\\n	show_block_html(new_html,target_div,append,inner);\\\\n\\\\n	// Scroll up if required\\\\n	if (scroll_to_top_of_wrapper)\\\\n	{\\\\n		try\\\\n		{\\\\n			window.scrollTo(0,find_pos_y(target_div));\\\\n		}\\\\n		catch (e) {}\\\\n	}\\\\n\\\\n	// Defined callback\\\\n	if (callback) callback();\\\\n}\\\\n\\\\nfunction show_block_html(new_html,target_div,append,inner)\\\\n{\\\\n	var raw_ajax_grow_spot=get_elements_by_class_name(target_div,'raw_ajax_grow_spot');\\\\n	if (typeof raw_ajax_grow_spot[0]!='undefined' && append) target_div=raw_ajax_grow_spot[0]; // If we actually are embedding new results a bit deeper\\\\n	if (append)\\\\n	{\\\\n		set_inner_html(target_div,new_html,true,true);\\\\n	} else\\\\n	{\\\\n		if (inner)\\\\n		{\\\\n			set_inner_html(target_div,new_html);\\\\n		} else\\\\n		{\\\\n			set_outer_html(target_div,new_html);\\\\n		}\\\\n	}\\\\n}\\\\n\\\\nfunction ajax_form_submit__admin__headless(event,form,block_name,map)\\\\n{\\\\n	if (typeof window.clever_find_value=='undefined') return true;\\\\n\\\\n	cancel_bubbling(event);\\\\n\\\\n	var post='';\\\\n	if (typeof block_name!='undefined')\\\\n	{\\\\n		if (typeof map=='undefined') map='';\\\\n		var comcode='[block'+map+']'+block_name+'[/block]';\\\\n		post+='data='+window.encodeURIComponent(comcode);\\\\n	}\\\\n	for (var i=0;i<form.elements.length;i++)\\\\n	{\\\\n		if (!form.elements[i].disabled && typeof form.elements[i].name!='undefined' && form.elements[i].name!=null && form.elements[i].name!='')\\\\n			post+='&'+form.elements[i].name+'='+window.encodeURIComponent(clever_find_value(form,form.elements[i]));\\\\n	}\\\\n	var request=do_ajax_request(maintain_theme_in_link('\\\",\\n	ecv_FIND_SCRIPT_NOHTTP(\\\$cl,array(2),array(\\\"comcode_convert\\\")),\\n	\\\"'+keep_stub(true)),null,post);\\\\n\\\\n	if ((request.responseText!='') && (request.responseText!=''))\\\\n	{\\\\n		if (request.responseText!='false')\\\\n		{\\\\n			var result_tags=request.responseXML.documentElement.getElementsByTagName('result');\\\\n			if ((result_tags) && (result_tags.length!=0))\\\\n			{\\\\n				var result=result_tags[0];\\\\n				var xhtml=merge_text_nodes(result.childNodes);\\\\n\\\\n				var element_replace=form;\\\\n				while (element_replace.className!='form_ajax_target')\\\\n				{\\\\n					element_replace=element_replace.parentNode;\\\\n					if (!element_replace) return true; // Oh dear, target not found\\\\n				}\\\\n\\\\n				set_inner_html(element_replace,xhtml);\\\\n\\\\n				window.fauxmodal_alert('\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"SUCCESS\\\",array()),\\n	\\\"');\\\\n\\\\n				return false; // We've handled it internally\\\\n			}\\\\n		}\\\\n	}\\\\n\\\\n	return true;\\\\n}\\\\n\\\\n/*\\\\n	Validation\\\\n*/\\\\n\\\\n/* Calls up a URL to check something, giving any 'feedback' as an error (or if just 'false' then returning false with no message) */\\\\nfunction do_ajax_field_test(url,post)\\\\n{\\\\n	if (typeof window.keep_stub!='undefined') url=url+keep_stub();\\\\n	var xmlhttp=do_ajax_request(url,null,post);\\\\n	if ((xmlhttp.responseText!='') && (xmlhttp.responseText.replace(/[ \\\\\\\\t\\\\\\\\n\\\\\\\\r]/g,'')!='0'/*some cache layers may change blank to zero*/))\\\\n	{\\\\n		if (xmlhttp.responseText!='false')\\\\n		{\\\\n			if (xmlhttp.responseText.length>1000)\\\\n			{\\\\n				if (typeof window.console!='undefined') console.log(xmlhttp.responseText);\\\\n\\\\n				fauxmodal_alert(xmlhttp.responseText,null,'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"ERROR_OCCURRED\\\",array()),\\n	\\\"',true);\\\\n			} else\\\\n			{\\\\n				window.fauxmodal_alert(xmlhttp.responseText);\\\\n			}\\\\n		}\\\\n		return false;\\\\n	}\\\\n	return true;\\\\n}\\\\n\\\\n/*\\\\n	Request backend\\\\n*/\\\\n\\\\nfunction do_ajax_request(url,callback__method,post) // Note: 'post' is not an array, it's a string (a=b)\\\\n{\\\\n	var synchronous=!callback__method;\\\\n\\\\n	if ((url.indexOf('://')==-1) && (url.substr(0,1)=='/'))\\\\n	{\\\\n		url=window.location.protocol+'//'+window.location.host+url;\\\\n	}\\\\n\\\\n	if ((typeof window.AJAX_REQUESTS=='undefined') || (!window.AJAX_REQUESTS)) return null; // Probably the page is in process of being navigated away so window object is gone\\\\n\\\\n	var index=window.AJAX_REQUESTS.length;\\\\n	window.AJAX_METHODS[index]=callback__method;\\\\n\\\\n	var base=window.location.protocol+'//'+window.location.host+'/';\\\\n	if ((url.substr(0,base.length)!=base) && (typeof window.XDomainRequest!='undefined') && ((typeof window.XMLHttpRequest!='undefined') && (typeof (new XMLHttpRequest().responseType)=='undefined')))\\\\n	{\\\\n		window.AJAX_REQUESTS[index]=new XDomainRequest(); // <IE10\\\\n	} else\\\\n	{\\\\n		window.AJAX_REQUESTS[index]=new XMLHttpRequest();\\\\n	}\\\\n	if (!synchronous) window.AJAX_REQUESTS[index].onreadystatechange=process_request_changes;\\\\n	if (typeof post!='undefined' && post!==null)\\\\n	{\\\\n		if (post.indexOf('&csrf_token')==-1)\\\\n			post+='&csrf_token='+window.encodeURIComponent(get_csrf_token()); // For CSRF prevention\\\\n\\\\n		window.AJAX_REQUESTS[index].open('POST',url,!synchronous);\\\\n		window.AJAX_REQUESTS[index].setRequestHeader('Content-Type','application/x-www-form-urlencoded');\\\\n		window.AJAX_REQUESTS[index].send(post);\\\\n	} else\\\\n	{\\\\n		window.AJAX_REQUESTS[index].open('GET',url,!synchronous);\\\\n		window.AJAX_REQUESTS[index].send(null);\\\\n	}\\\\n\\\\n	if ((typeof window.AJAX_REQUESTS=='undefined') || (!window.AJAX_REQUESTS)) return null; // Probably the page is in process of being navigated away so window object is gone\\\\n	var result=window.AJAX_REQUESTS[index];\\\\n	if (synchronous)\\\\n	{\\\\n		window.AJAX_REQUESTS[index]=null;\\\\n	}\\\\n	return result;\\\\n}\\\\n\\\\nfunction process_request_changes()\\\\n{\\\\n	if ((typeof window.AJAX_REQUESTS=='undefined') || (!window.AJAX_REQUESTS)) return null; // Probably the page is in process of being navigated away so window object is gone\\\\n\\\\n	// If any AJAX_REQUESTS are 'complete'\\\\n	var i,result;\\\\n	for (i=0;i<window.AJAX_REQUESTS.length;i++)\\\\n	{\\\\n		result=window.AJAX_REQUESTS[i];\\\\n		if ((result!=null) && (result.readyState) && (result.readyState==4/*done*/))\\\\n		{\\\\n			window.AJAX_REQUESTS[i]=null;\\\\n\\\\n			// If status is 'OK'\\\\n			var result_status=result.status;\\\\n			if (result_status>10000) result_status=0; // Weird IE status, see http://stackoverflow.com/questions/872206/http-status-code-0-what-does-this-mean-in-ms-xmlhttp/905751#905751\\\\n			if ((result_status) && ((result_status==200) || (result_status==500) || (result_status==400) || (result_status==401)))\\\\n			{\\\\n				// Process the result\\\\n				if (window.AJAX_METHODS[i])\\\\n				{\\\\n					// Text result? Handle with a very simple call\\\\n					if ((!result.responseXML/*Not payload handler and not stack trace*/ || result.responseXML.childNodes.length==0))\\\\n					{\\\\n						return call_ajax_method(window.AJAX_METHODS[i],result,null);\\\\n					}\\\\n				}\\\\n\\\\n				var xml=handle_errors_in_result(result);\\\\n				if (xml)\\\\n				{\\\\n					// XML result. Handle with a potentially complex call\\\\n					xml.validateOnParse=false;\\\\n					var ajax_result_frame=xml.documentElement;\\\\n					if (!ajax_result_frame) ajax_result_frame=xml;\\\\n					process_request_change(ajax_result_frame,i);\\\\n				} else\\\\n				{\\\\n					// Error parsing\\\\n					if (window.AJAX_METHODS[i])\\\\n					{\\\\n						call_ajax_method(window.AJAX_METHODS[i],null,null);\\\\n					}\\\\n				}\\\\n			}\\\\n			else\\\\n			{\\\\n				// HTTP error...\\\\n\\\\n				if (window.AJAX_METHODS[i])\\\\n				{\\\\n					call_ajax_method(window.AJAX_METHODS[i],null,null);\\\\n				}\\\\n\\\\n				try\\\\n				{\\\\n					if (result_status==0) // 0 implies site down, or network down\\\\n					{\\\\n						if ((!window.network_down) && (!window.unloaded))\\\\n						{\\\\n							//window.fauxmodal_alert('\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"NETWORK_DOWN\\\",array()),\\n	\\\"');	Annoying because it happens when unsleeping a laptop (for example)\\\\n							window.network_down=true;\\\\n						}\\\\n					} else\\\\n					{\\\\n						if (typeof console.log!='undefined') console.log('\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"PROBLEM_RETRIEVING_XML\\\",array()),\\n	\\\"\\\\\\\\n'+result_status+': '+result.statusText+'.');\\\\n					}\\\\n				}\\\\n				catch (e)\\\\n				{\\\\n					if (typeof console.log!='undefined') console.log('\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"PROBLEM_RETRIEVING_XML\\\",array()),\\n	\\\"');		// This is probably clicking back\\\\n				}\\\\n			}\\\\n		}\\\\n	}\\\\n}\\\\n\\\\nfunction handle_errors_in_result(result)\\\\n{\\\\n	if ((result.responseXML==null) || (result.responseXML.childNodes.length==0))\\\\n	{\\\\n		// Try and parse again. Firefox can be weird.\\\\n		var xml;\\\\n		if (typeof DOMParser!='undefined')\\\\n		{\\\\n			try { xml=(new DOMParser()).parseFromString(result.responseText,'application/xml'); }\\\\n			catch(e) {}\\\\n		} else\\\\n		{\\\\n			var ieDOM=['MSXML2.DOMDocument','MSXML.DOMDocument','Microsoft.XMLDOM'];\\\\n			for (var i=0;i<ieDOM.length && !xml;i++) {\\\\n				try { xml=new ActiveXObject(ieDOM[i]);xml.loadXML(result.responseText); }\\\\n				catch(e) {}\\\\n			}\\\\n		}\\\\n		if (xml) return xml;\\\\n\\\\n		if ((result.responseText) && (result.responseText!='') && (result.responseText.indexOf('<html')!=-1))\\\\n		{\\\\n			if (typeof window.console!='undefined') console.log(result);\\\\n\\\\n			fauxmodal_alert(result.responseText,null,'\\\",\\n	ecv(\\\$cl,array(2,8),2,\\\"ERROR_OCCURRED\\\",array()),\\n	\\\"',true);\\\\n		}\\\\n		return false;\\\\n	}\\\\n	return result.responseXML;\\\\n}\\\\n\\\\nfunction process_request_change(ajax_result_frame,i)\\\\n{\\\\n	if (!ajax_result_frame) return null; // Needed for Opera\\\\n	if ((typeof window.AJAX_REQUESTS=='undefined') || (!window.AJAX_REQUESTS)) return null; // Probably the page is in process of being navigated away so window object is gone\\\\n\\\\n	var method=null;\\\\n	if ((ajax_result_frame.getElementsByTagName('method')[0]) || (window.AJAX_METHODS[i]))\\\\n	{\\\\n		method=(ajax_result_frame.getElementsByTagName('method')[0])?eval('return '+merge_text_nodes(ajax_result_frame.getElementsByTagName('method')[0])):window.AJAX_METHODS[i];\\\\n	}\\\\n\\\\n	if (ajax_result_frame.getElementsByTagName('message')[0])\\\\n	{\\\\n		// Either an error or a message was returned. :(\\\\n		var message=ajax_result_frame.getElementsByTagName('message')[0].firstChild.data;\\\\n\\\\n		call_ajax_method(method,null,null);\\\\n\\\\n		if (ajax_result_frame.getElementsByTagName('error')[0])\\\\n		{\\\\n			// It's an error :|\\\\n			window.fauxmodal_alert('An error ('+ajax_result_frame.getElementsByTagName('error')[0].firstChild.data+') message was returned by the server: '+message);\\\\n			return null;\\\\n		}\\\\n\\\\n		window.fauxmodal_alert('An informational message was returned by the server: '+message);\\\\n		return null;\\\\n	}\\\\n\\\\n	var ajax_result=ajax_result_frame.getElementsByTagName('result')[0];\\\\n	if (!ajax_result)\\\\n	{\\\\n		call_ajax_method(method,null,null);\\\\n		return null;\\\\n	}\\\\n\\\\n	call_ajax_method(method,ajax_result_frame,ajax_result);\\\\n\\\\n	return null;\\\\n}\\\\n\\\\nfunction call_ajax_method(method,ajax_result_frame,ajax_result)\\\\n{\\\\n	if (method instanceof Array)\\\\n	{\\\\n		if (ajax_result_frame!=null)\\\\n		{\\\\n			method=(typeof method[0]=='undefined')?null:method[0];\\\\n		} else\\\\n		{\\\\n			method=(typeof method[1]=='undefined')?null:method[1];\\\\n		}\\\\n	} else\\\\n	{\\\\n		if (ajax_result_frame==null) method=null; // No failure method given, so don't call\\\\n	}\\\\n\\\\n	if (method!=null)\\\\n	{\\\\n		if (typeof method.response!='undefined')\\\\n		{\\\\n			method.response(ajax_result_frame,ajax_result);\\\\n		} else\\\\n		{\\\\n			method(ajax_result_frame,ajax_result);\\\\n		}\\\\n	}\\\\n}\\\\n\\\\nfunction merge_text_nodes(childNodes)\\\\n{\\\\n	var i,text='';\\\\n	for (i=0;i<childNodes.length;i++)\\\\n	{\\\\n		if (childNodes[i].nodeName=='#text')\\\\n		{\\\\n			text+=childNodes[i].data;\\\\n		}\\\\n	}\\\\n	return text;\\\\n}\\\\n\\\\n\\\";\");\";}}");

